<!DOCTYPE html><html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /><title>Insertion sort algorithm &mdash; Algviz</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zjl9959/algviz.com@master/assets/vendor/primer-css/css/primer.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zjl9959/algviz.com@master/assets/css/sections/repo-list.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zjl9959/algviz.com@master/assets/css/globals/common.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zjl9959/algviz.com@master/assets/css/globals/responsive.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zjl9959/algviz.com@master/assets/css/posts/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zjl9959/algviz.com@master/assets/vendor/octicons/octicons/octicons.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zjl9959/algviz.com@master/assets/css/pages/index.css"><link rel="canonical" href="https://algviz.com/en/InsertionSort/"><link rel="alternate" type="application/atom+xml" title="Algviz" href="https://algviz.com/feed.xml"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/zjl9959/algviz.com@master/favicon.ico"><meta property="og:title" content="Insertion sort algorithm"><meta name="keywords" content="Algorithm visualization Python animation data structure"><meta name="og:keywords" content="Algorithm visualization Python animation data structure"><meta name="description" content="Insertion sort is a simple and naive sorting method, which processes the unsorted elements in the unordered part sequentially and inserts them into the correct position in the sorted part."><meta name="og:description" content="Insertion sort is a simple and naive sorting method, which processes the unsorted elements in the unordered part sequentially and inserts them into the correct position in the sorted part."><meta property="og:url" content="https://algviz.com/en/InsertionSort/"><meta property="og:site_name" content="Algviz"><meta property="og:type" content="article"><meta property="og:locale" content="en_US" /><meta property="article:published_time" content="2022-09-17"> <script src="https://cdn.jsdelivr.net/gh/zjl9959/algviz.com@master/assets/vendor/jquery/dist/jquery.min.js"></script> <script src="https://cdn.jsdelivr.net/gh/zjl9959/algviz.com@master/assets/js/jquery-ui.js"></script> <script src="https://cdn.jsdelivr.net/gh/zjl9959/algviz.com@master/assets/js/main.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-4Z0KQSTDLS"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-4Z0KQSTDLS'); </script></head><body class="" data-mz=""><header class="site-header"><div class="container"> <span><a href="https://algviz.com/" title="Algviz"> <img class="header-logo" src="https://cdn.jsdelivr.net/gh/zjl9959/algviz.com@master/assets/img/logo.svg" alt="algviz.com"> </a></span> <button class="collapsed mobile-visible" type="button" onclick="toggleMenu();"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button><nav class="site-header-nav" role="navigation"> <a href="https://algviz.com/en/index.html" class=" site-header-nav-item" target="" title="Home">Home</a> <a href="https://algviz.com/en/about.html" class=" site-header-nav-item" target="" title="About">About</a> <a href="https://algviz.com/cn/InsertionSort/" class="site-header-nav-item"><img src="/assets/img/flag-us.svg" class="site-header-nav-flag"></a></nav></div></header><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zjl9959/algviz.com@master/assets/css/globals/base16.monokai.css"> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script> MathJax = { tex: { inlineMath: [['$', '$']], processEscapes: true } }; </script><section class="collection-head small geopattern" data-pattern-id="Insertion sort "><div class="container"><div class="columns"><div class="column three-fourths"><div class="collection-title"><h1 class="collection-header">Insertion sort algorithm</h1><div class="collection-info"> <span class="meta-info" style="padding-right:3px"> <span class="octicon octicon-calendar"></span> 2022/09/17 </span> <span class="meta-info" style="padding-right:3px"> <span class="octicon octicon-file-directory"></span> <a href="https://algviz.com/en/categories/#SortingAlgorithm" title="SortingAlgorithm">SortingAlgorithm</a> </span> <span class="meta-info" style="padding-right:3px"> <span class="octicon octicon-clock"></span> 3554 words in total, about 11 minutes </span></div></div></div></div></div></section><br><section class="container content"><div class="columns"><div class="column three-fourths" ><article class="article-content markdown-body"><p>Insertion sort is a simple and naive sorting method, which processes the unsorted elements in the unordered part sequentially and inserts them into the correct position in the sorted part.</p><h2 id="fundamental">Fundamental</h2><p>Suppose we have an unordered set of elements, we can divide it into two parts, one part needs to be arranged in order from small to large, and the other part remains unordered. Then, we just need to take one element from the unordered part at a time and insert it into the correct position in the ordered part.</p><p>The process of finding a suitable insertion position can be simplified to find a position $i$ in the ordered part, so that the element at position $i$ is less than or equal to the element to be inserted, and the element at position $i+1$ is greater than the element to be inserted.</p><h2 id="implementation">Implementation</h2><p>Here is the Python code implementation of the insertion sort algorithm (with animation demonstration):</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">algviz</span>

<span class="k">def</span> <span class="nf">insertSort</span><span class="p">(</span><span class="n">nums_</span><span class="p">):</span>
    <span class="n">viz</span> <span class="o">=</span> <span class="n">algviz</span><span class="p">.</span><span class="n">Visualizer</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">nums</span> <span class="o">=</span> <span class="n">viz</span><span class="p">.</span><span class="n">createVector</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">nums_</span><span class="p">,</span> <span class="n">cell_size</span><span class="o">=</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span> <span class="n">histogram</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">show_index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="c1"># Start with the second element.
</span>    <span class="k">for</span> <span class="n">ed</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums_</span><span class="p">)):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">ed</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ed</span>
        <span class="n">nums</span><span class="p">.</span><span class="n">mark</span><span class="p">(</span><span class="n">algviz</span><span class="p">.</span><span class="n">color_silver</span><span class="p">,</span> <span class="n">ed</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">),</span> <span class="n">hold</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">viz</span><span class="p">.</span><span class="n">display</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">nums</span><span class="p">.</span><span class="n">mark</span><span class="p">(</span><span class="n">algviz</span><span class="p">.</span><span class="n">color_red</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">nums</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
                <span class="n">nums</span><span class="p">.</span><span class="n">mark</span><span class="p">(</span><span class="n">algviz</span><span class="p">.</span><span class="n">color_gold</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span> <span class="n">viz</span><span class="p">.</span><span class="n">display</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nums</span><span class="p">.</span><span class="n">mark</span><span class="p">(</span><span class="n">algviz</span><span class="p">.</span><span class="n">color_green</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">viz</span><span class="p">.</span><span class="n">display</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
            <span class="c1"># Inserts an element after the first element to its left that is not larger than it.
</span>            <span class="n">nums</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nums</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
            <span class="n">nums</span><span class="p">.</span><span class="n">removeMark</span><span class="p">(</span><span class="n">algviz</span><span class="p">.</span><span class="n">color_green</span><span class="p">);</span> <span class="n">viz</span><span class="p">.</span><span class="n">display</span><span class="p">()</span>
        <span class="n">nums</span><span class="p">.</span><span class="n">removeMark</span><span class="p">(</span><span class="n">algviz</span><span class="p">.</span><span class="n">color_silver</span><span class="p">)</span>
    <span class="n">viz</span><span class="p">.</span><span class="n">display</span><span class="p">()</span>

<span class="n">insertSort</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
</code></pre></div></div><p><em>You can run this snippet directly after installing algviz locally! For environment configuration, please refer to: <a href="http://localhost:4000/en/about.html#installation">Installation</a></em></p><h3 id="animation-demo">Animation Demo</h3><p>For the convenience of observation, the array is divided into two parts: an ordered part and an unordered part (marked in gray). The algorithm processes the leftmost element (marked in red) in the unordered part each round, and compare the element with the elements in the ordered part <strong>in order from right to left</strong> 👈. If the element being compared in the ordered part is larger than that element, then it is marked as green, and the algorithm continues to search towards left. Otherwise, it is marked as yellow and the algorithm stops searching and inserts the element to be processed at the current position. As the algorithm runs, we can observe that the unordered part of the array becomes less and less, and we end up with a completely ordered array!</p><p><img src="https://cdn.jsdelivr.net/gh/zjl9959/algviz-launch@master/svgs/InsertionSort2.svg" alt="insertion_sort_example" /></p><h2 id="features">Features</h2><h3 id="complexity">Complexity</h3><p>Two layers of loops are required in the implementation of the insertion sort algorithm. The first level loop processes each unsorted element of the array in turn, and the second level loop finds a suitable insertion position for the element, so the overall <strong>time</strong> complexity is $O(n^2)$.</p><p>Insertion sort algorithm can operate directly on the input sequence, and it does not require additional storage space, so the <strong>space</strong> complexity is $O(1)$.</p><h3 id="scenarios">Scenarios</h3><p>The insertion sort algorithm belongs to the <strong>comparison-based</strong> sorting algorithm, and the sorting result is stable (that is: <em>the relative positions of logically equal elements in the original input sequence do not change</em>).</p><p>This algorithm is not suitable for sorting large-scale sequences when the current storage space is relatively cheap and the running speed of the CPU encounters a bottleneck. However, because the algorithm is simple to implement and the constant term in its time complexity is small, the algorithm may run faster on some small-scale problems.</p><h2 id="optimization">Optimization</h2><p>Do we have any optimization opportunities in the link of searching for the right insertion position?</p><p>Of course we have! Since the search is performed in an <strong>ordered array</strong>, we can use a faster <strong>binary search</strong> algorithm instead of the original <strong>sequential search</strong> algorithm. Try it yourself if you are interested!</p><p>PS: although the time complexity of the binary search algorithm is $O(log_2^n)$, but since the insertion sort algorithm needs $O(n)$ time complexity every time to move the element to be inserted, so the overall time complexity of the algorithm will not be reduced.</p><br><div class="article-license"><p>This article follows the<a href="https://creativecommons.org/licenses/by-nd/2.0/"> Attribution-NoDerivs 2.0 Generic</a> license. <img src="/assets/img/license.png" alt="Attribution-NoDerivs 2.0 Generic"></p></div></article></div><div class="column one-fourth"><h3>Search:</h3><div id="site_search"> <input style="width:96%" type="text" id="search_box" placeholder="Search"></div><ul id="search_results" style="font-size:14px;list-style-type:none;padding-top:10px;padding-left:10px;"></ul><script src="https://cdn.jsdelivr.net/gh/zjl9959/algviz.com@master/assets/js/simple-jekyll-search.min.js"></script> <script type="text/javascript"> SimpleJekyllSearch({ searchInput: document.getElementById('search_box'), resultsContainer: document.getElementById('search_results'), json: 'https://algviz.com/assets/search_data.json?v=1663768140', searchResultTemplate: '<li><a href="{url}" title="{title}">{title}</a></li>', noResultsText: 'No results found', limit: 5, fuzzy: false, exclude: ['algviz'] }) </script><div id="post-directory-module" class="mobile-hidden"><section class="post-directory"><dl></dl></section></div><script src="https://cdn.jsdelivr.net/gh/zjl9959/algviz.com@master/assets/js/jquery.toc.en.js"></script></div></div></section><footer class="container"><div class="site-footer" role="contentinfo"><div class="copyright left mobile-block"> © 2022 <span title="zjl9959">zjl9959</span> <a href="javascript:window.scrollTo(0,0)" class="right mobile-visible">TOP</a></div><ul class="site-footer-links right mobile-hidden"><li> <a href="javascript:window.scrollTo(0,0)" >TOP</a></li></ul><a href="https://github.com/zjl9959/algviz" target="_blank" aria-label="view source code"> <span class="mega-octicon octicon-mark-github" title="GitHub"></span> </a><ul class="site-footer-links mobile-hidden"><li> <a href="https://algviz.com/en/index.html" title="Home" target="">Home</a></li><li> <a href="https://algviz.com/en/about.html" title="About" target="">About</a></li><li><a href="https://algviz.com/feed.xml"><span class="octicon octicon-rss" style="color:orange;"></span></a></li></ul></div></footer><div class="tools-wrapper"> <a class="gotop" href="#" title="TOP"><span class="octicon octicon-arrow-up"></span></a></div></body></html>
